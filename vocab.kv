#:kivy 2.0.0
### templates ###
# layout for word input boxes, they act like classes in CSS
<InputFloatLayout@FloatLayout>:
    size_hint: 1, None
    height: 50
# word inputs
<WordTextInput@TextInput>:
    pos_hint: {"x": 0.35, "top": 1}
    size_hint: 0.6, 1
    multiline: True
# word labels
<WordLabel@Label>:
    pos_hint: {"x": 0.05, "top": 1}
    size_hint: 0.25, 1
    color: 0, 0, 0, 1
    font_size: 35
# seperators
<SepLabel@Label>:
    size_hint: None, None
    size: root.width, 20

# back button in top bar, manually put on_press function
<BackButton@Button>:
    pos_hint: {"x": 0, "top": 1}
    size_hint: 0.1, 1
    background_normal:'back.png'
<TitleLabel@Label>:
    pos_hint: {"x": 0.2, "top": 1}
    size_hint: 0.7, 1
    color: 1, 1, 1, 1
# top bar with back button and title (should I remove it?)
<TopBar@FloatLayout>:
    pos_hint: {"x": 0, "top": 1}
    size_hint: 1, 0.05
    cols: 3
    canvas.before:
        Color:
            rgb: 0, 0, 0
        Rectangle:
            size: self.size
            pos: self.pos
    Label:
        pos_hint: {"x": 0.9, "top": 1}
        size_hint: 0.1, 1

<answerchx@CheckBox>:
    group:'answers'  
    size_hint: 0.05, 0.03
# labels for the 4 answers
<anslbl@Label>:
    text:''
    color: 0, 0, 0, 1
    size_hint: 0.7, 0.1  
    halign: 'left'
    valign: 'middle'
    text_size: self.size
    
###################################

<Main>:
    total_answered: total_answered
    correctness: correctness
    greetings: greetings

    word:  word
    ans1:  ans1
    ans2:  ans2
    ans3:  ans3
    ans4:  ans4
    ans1t: ans1t
    ans2t: ans2t
    ans3t: ans3t
    ans4t: ans4t
    next:  next

    correct_percentage: correct_percentage
    correct_num: correct_num
    incorrect_num: incorrect_num

    FloatLayout: 
        # blue square on title page
        canvas.before:
            Color:
                rgb: 15/255, 144/255, 1
            RoundedRectangle:
                size: self.width, self.height * 0.15
                pos: 0, self.height - self.height * 0.15
                radius: 10, 10, 10, 10

            # blue, white square in the middle
            Color:
                rgb: 128/255, 223/255, 1
            RoundedRectangle:
                size: self.width - 20, self.height * 0.4
                pos: 10, self.height - self.height * 0.65 - 15
                radius: 50, 50, 50, 50

            Color:
                rgb: 240/255, 1, 1
            RoundedRectangle:
                size: self.width - 40, self.height * 0.37
                pos: 20, self.height - self.height * 0.65
                radius: 50, 50, 50, 50

            # commented out because this will go to the user info popup
            # Color:
            #     rgba:
            #         102/255, 163/255, 1, 0.4
            # RoundedRectangle:
            #     size: self.width - 20, self.height * 0.3
            #     pos: 10, self.height - self.height * 0.53
            #     radius: 10, 10, 10, 10


        # Top section with name, list, title
        # ----------------------------------
        Button:
            pos_hint: {"x" : 0.04, "top" : 0.992}
            size_hint: 0.1, 0.05
            background_normal: "list.png"

        Label:
            id: greetings
            pos_hint: {"x": 0.45, "top": 0.98}
            size_hint: 0.55, 0.1
            text_size: self.size
            font_size: 35
            halign: 'center'
            valign: 'top'
            text: 'Good Morning, Kepha'

        # label: 'Vocabulary Learner' title
        Label:
            pos_hint: {"left": 0, "top": 0.91}
            size_hint: 1, 0.05
            halign: 'center'
            valign: 'center'
            text: 'Vocabulary Learner'
            color: 1, 1, 1, 1
            font_size: 40
            bold: True

        # Bottom Bar
        GridLayout:
            rows: 1
            cows: 3
            pos_hint: {"x": 0, "bottom": 0}
            size_hint: 1, 0.1

            Button: # arrange words
                text: 'word list'
                on_release: 
                    root.manager.get_screen('words_list').update()
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'words_list'

            Button: # main play button
                text: 'play now'
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'main_screen'

            Button: # add words
                text: 'dictionary'
                on_release: 
                    root.manager.get_screen('dictionary').update()
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'dictionary'

        # 2 CPBs for total answered and correctness respectively
        # temp. invisible  because this will go to the user info popup
        CircularProgressBar:
            id: total_answered
            pos: -1000, -1000 # here
            max: 1
            value: 0
            cap_style: 'square'

        CircularProgressBar:
            id: correctness
            pos: -1000, -1000 # and here
            max: 1
            value: 0
            cap_style: 'square'

        # questions part
        # --------------

        # big word on top
        Label:
            id: word
            pos_hint: {"x": 0.2, "top": 0.825}
            size_hint: 0.6, 0.08
            color: 0, 0, 0, 1
            font_size: 40
            text: ''
            canvas.before:
                Color:
                    rgba: 102/255, 153/255, 1, 0.6
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: 25, 25, 25, 25

        # question label
        Label:
            text: 'What is the meaning of this word?'
            pos_hint: {"x": 0, "top": 0.74}
            size_hint: 0.9, 0.1
            color: 0, 0, 0, 1
            font_size: 33

        # (+0.08, +0.035) -- relationship between checkbox and label
        # +0.8 y between checkboxes
        answerchx:
            id: ans1
            pos_hint: {"x": 0.12, "top": 0.65}
            on_release: root.check(self)
        anslbl:
            id: ans1t
            pos_hint: {"x": 0.2, "top": 0.685}

        answerchx:
            id: ans2
            pos_hint: {"x": 0.12, "top": 0.57}
            on_release: root.check(self)
        anslbl:
            id: ans2t
            pos_hint: {"x": 0.2, "top": 0.605}

        answerchx:
            id: ans3
            pos_hint: {"x": 0.12, "top": 0.49}
            on_release: root.check(self)
        anslbl:
            id: ans3t
            pos_hint: {"x": 0.2, "top": 0.525}

        answerchx:
            id:ans4
            pos_hint: {"x": 0.12, "top": 0.41}
            on_release: root.check(self)
        anslbl:
            id: ans4t
            pos_hint: {"x": 0.2, "top": 0.445}
            
        # the 'next' button, goes to next question. check()
        Button:
            id: next
            size_hint: 0.3, 0.065
            pos_hint: {"x": 0.6, "top": 0.32}
            text: "Next"
            font_size: 40
            on_press: root.nextWord()
            background_color: 15/255, 144/255, 1, 0
            canvas.before:
                Color:
                    rgb: 15/255, 144/255, 1
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: 25, 25, 25, 25  

        # CPB for correct percentage                             
        CircularProgressBar:
            id: correct_percentage
            size_hint: 0.2, 0.2
            pos: 50, 170
            thickness: 13
            progress_colour: 204/255, 153/255, 1
            max: 10
            value: 1
            cap_style: 'square'

        # these 2 labels needs to be made prettier
        # the number of times the question is answered (in)correctly
        Label:
            id: correct_num
            color: 0, 0, 0, 1
            size_hint: 0.4, 0.08
            pos_hint: {"x": 0.55, "top": 0.25}
            text_size: self.size
            text: "Answered correctly "
            canvas.before:
                Color:
                    rgb: 240/255, 1, 1
                RoundedRectangle:
                    size: self.width + 25, self.height * 2 + 30
                    pos: self.width + 75, self.height - 30
                    radius: 25, 25, 25, 25   
        Label:
            id: incorrect_num
            color: 0, 0, 0, 1
            size_hint: 0.4, 0.08
            pos_hint: {"x": 0.55, "top": 0.18}
            text_size: self.size
            text: "Ansered Incorrectly "

<AddWords>:
    word: word
    mean1: mean1
    mean2: mean2
    mean3: mean3
    word_list_btn: word_list_btn
    confirm: confirm
    cancel: cancel

    # top bar
    TopBar:
        BackButton:
            on_release:
                root.manager.get_screen('words_list').update()
                root.manager.transition.direction = 'right' 
                root.manager.current = 'words_list'
        TitleLabel:
            text: "Add Words"

    # main add words section (inputs, checkboxes, etc)
    ScrollView:
        do_scroll: True
        pos_hint: {"x": 0, "top": 0.93}
        GridLayout:
            size_hint_y: None
            height: self.minimum_height
            pos: 0, 0
            size_hint_x: 1
            cols: 1
            
            # main vocab word
            InputFloatLayout:
                WordLabel:
                    text: 'Word: '
                WordTextInput:
                    id: word
                    hint_text: 'Enter word'
                    mutiline: False
                    on_text_validate: 
            SepLabel

            # 3 meanings textinputs

            InputFloatLayout:
                WordLabel:
                    text: 'Meaning: '
                WordTextInput:
                    id: mean1
                    hint_text: 'Enter the meaning'
            SepLabel

            InputFloatLayout:
                WordLabel
                WordTextInput:
                    id: mean2
                    hint_text:'Enter the 2nd meaning (optional)'
            SepLabel
            
            InputFloatLayout:
                WordLabel
                WordTextInput:
                    id: mean3
                    hint_text: 'Enter the 3rd meaning (optional)'

            SepLabel:
                height: 100

            # dropdown list for word lists
            InputFloatLayout:
                size_hint_y: None
                height: 600
                Button:
                    id: word_list_btn
                    pos_hint: {"center_x": 0.5, "top": 1}
                    size_hint: 0.7, 0.1
                    on_press: root.dropdown.open(self)
                    text: "choose list"

            SepLabel:
                height: 100

            # contains confirm and cancel buttons
            InputFloatLayout:
                height: 80
                Button:
                    id: confirm
                    pos_hint: {"x": 0.1, "top": 1}
                    size_hint: 0.25, 1
                    background_normal: 'confirm.png'
                    on_release: root.confirm_pressed()

                Button:
                    id: cancel
                    pos_hint: {"x": 0.65, "top": 1}
                    size_hint: 0.25, 1
                    background_normal: 'cancel.png'
                    on_press: root.cancel_pressed()


<Dictionary>:
    search_textbox: search_textbox
    search_button: search_button
    target_word: target_word
    word_missing: word_missing
    meaning1: meaning1
    meaning2: meaning2
    meaning3: meaning3

    FloatLayout:
        # White block for the definition of the srarched word
        canvas.before:
            Color:
                rgb: 240/255, 1, 1
            RoundedRectangle:
                size: self.width, self.height * 0.45
                pos: 0, self.height - self.height * 0.65
                radius: (50, 50, 50, 50)

        # Bottom Bar
        GridLayout:
            rows: 1
            cows: 3
            pos_hint: {"x": 0, "bottom": 0}
            size_hint: 1, 0.1

            Button: # arrange words
                text: 'word list'
                on_release: 
                    root.manager.get_screen('words_list').update()
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'words_list'

            Button: # main play button
                text: 'play now'
                on_release:
                    root.manager.get_screen('main_screen').update()
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'main_screen'

            Button: # add words
                text: 'dictionary'
                on_release: 
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'dictionary'

        # search textbox
        TextInput:
            id: search_textbox
            pos_hint: {"x": 0.1, "top": 0.9}
            size_hint: 0.7, 0.07
            multiline: False
            on_text_validate: root.show()
        # search bottom
        Button:
            id: search_button
            pos_hint: {"x": 0.8, "top": 0.9}
            size_hint: 0.14, 0.07
            on_press: root.show()

        # main word label
        Label:
            id: target_word
            pos_hint: {"x": 0.1, "top": 0.8}
            size_hint: 1, 0.1
            halign: 'left'
            font_size: 40
            text_size: self.size
            color: 0, 0, 0, 1

        # if word does not exist
        Label:
            id: word_missing
            pos_hint: {"x": 0.1, "top": 0.75}
            size_hint: 1, 0.1
            font_size: 35
            text_size: self.size
            halign: 'center'
            color: 0, 0, 0, 1

        # 3 meaning labels
        Label:
            id: meaning1
            pos_hint: {"x": 0.05, "top": 0.7}
            size_hint: 1, 0.1
            halign: 'left'
            font_size: 40
            text_size: self.size
            color: 0, 0, 0, 1

        Label:
            id: meaning2
            pos_hint: {"x": 0.05, "top": 0.6}
            size_hint: 1, 0.1
            halign: 'left'
            text_size: self.size
            font_size: 40
            color: 0, 0, 0, 1

        Label:
            id: meaning3
            pos_hint: {"x": 0.05, "top": 0.5}
            size_hint: 1, 0.1
            halign: 'left'
            text_size: self.size
            font_size: 40
            color: 0, 0, 0, 1
        


<WordsList>:
    main_layout: main_layout

    FloatLayout:
        id: main_layout

        # Bottom Bar
        GridLayout:
            rows: 1
            cows: 3
            pos_hint: {"x": 0, "bottom": 0}
            size_hint: 1, 0.1

            Button: # arrange words
                text: 'word list'
                on_release: 
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'words_list'

            Button: # main play button
                text: 'play now'
                on_release:
                    root.manager.get_screen('main_screen').update()
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'main_screen'

            Button: # add words
                text: 'dictionary'
                on_release: 
                    root.manager.get_screen('dictionary').update()
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'dictionary'

<SingleList>:
    list_name: list_name
    
    # top bar
    TopBar:
        BackButton:
            on_release:
                root.manager.get_screen('words_list').update()
                root.manager.transition.direction = 'left' 
                root.manager.current = 'words_list'
        TitleLabel:
            id: list_name

